!function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(i,a,function(t){return e[t]}.bind(null,a));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist",n(n.s=0)}([function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}function r(e,t,n){var i=t.get(e);if(!i)throw new TypeError("attempted to set private field on non-instance");if(i.set)i.set.call(e,n);else{if(!i.writable)throw new TypeError("attempted to set read only private field");i.value=n}return n}n.r(t);var o=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s.set(this,{writable:!0,value:void 0}),l.set(this,{writable:!0,value:void 0}),u.set(this,{writable:!0,value:null}),r(this,s,$(t)),r(this,l,1e3*n),this.initClasses(),this.initControls(),this.listenForKeyboard()}var t,n,o;return t=e,(n=[{key:"initClasses",value:function(){a(this,s).addClass("carousel slide"),a(this,s).find("ul").addClass("carousel-inner"),a(this,s).find("li").addClass("carousel-item"),a(this,s).find("img").addClass("d-block w-100"),a(this,s).find("li").filter(":first").addClass("active")}},{key:"initControls",value:function(){var e=this;a(this,s).append('<a class="carousel-control-prev" href="#" role="button" data-slide="prev"><span class="carousel-control-prev-icon" aria-hidden="true"></span><span class="sr-only">Previous</span></a>'),a(this,s).find(".carousel-control-prev").click((function(t){t.preventDefault(),e.previous()})),a(this,s).append('<a class="carousel-control-next" href="#" role="button" data-slide="next"><span class="carousel-control-next-icon" aria-hidden="true"></span><span class="sr-only">Next</span></a>'),a(this,s).find(".carousel-control-next").click((function(t){t.preventDefault(),e.next()})),a(this,s).find("img").click((function(){e.toggle()}))}},{key:"listenForKeyboard",value:function(){var e=this;$("body").keydown((function(t){37==(t.keyCode||t.which)?e.previous():39==(t.keyCode||t.which)?e.next():32==(t.keyCode||t.which)&&e.toggle()}))}},{key:"next",value:function(){var e=this.removeActiveLi(),t=e.next();0==t.length&&(t=e.siblings().filter(":first")),this.setActiveLi(t)}},{key:"previous",value:function(){var e=this.removeActiveLi(),t=e.prev();0==t.length&&(t=e.siblings().filter(":last")),this.setActiveLi(t)}},{key:"removeActiveLi",value:function(){var e=a(this,s).find(".active").filter(":first");return e.removeClass("active"),e}},{key:"setActiveLi",value:function(e){e.addClass("active")}},{key:"start",value:function(){var e=this;r(this,u,setInterval((function(){e.next()}),a(this,l)))}},{key:"stop",value:function(){clearInterval(a(this,u)),r(this,u,null)}},{key:"toggle",value:function(){null==a(this,u)?this.start():this.stop()}}])&&i(t.prototype,n),o&&i(t,o),e}(),s=new WeakMap,l=new WeakMap,u=new WeakMap;function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function v(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}var f=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),d.set(this,{writable:!0,value:void 0}),function(e,t,n){var i=t.get(e);if(!i)throw new TypeError("attempted to set private field on non-instance");if(i.set)i.set.call(e,n);else{if(!i.writable)throw new TypeError("attempted to set read only private field");i.value=n}}(this,d,L.map(t).setView(n,14)),L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:i}).addTo(v(this,d))}var t,n,i;return t=e,(n=[{key:"addMarker",value:function(e,t){L.marker(e).addTo(v(this,d)).on("click",t)}}])&&c(t.prototype,n),i&&c(t,i),e}(),d=new WeakMap;function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function p(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}function w(e,t,n){var i=t.get(e);if(!i)throw new TypeError("attempted to set private field on non-instance");if(i.set)i.set.call(e,n);else{if(!i.writable)throw new TypeError("attempted to set read only private field");i.value=n}return n}var m=function(){function e(t,n,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),y.set(this,{writable:!0,value:void 0}),b.set(this,{writable:!0,value:void 0}),g.set(this,{writable:!0,value:void 0}),k.set(this,{writable:!0,value:void 0}),w(this,y,t),w(this,b,n),w(this,g,i),w(this,k,a)}var t,n,i;return t=e,(n=[{key:"displayAllStations",value:function(){var e=this;$.ajax({dataType:"json",url:"https://api.jcdecaux.com/vls/v3/stations?contract="+p(this,k)+"&apiKey="+p(this,g),context:this}).done((function(t){t.forEach((function(t){p(e,y).addMarker([t.position.latitude,t.position.longitude],(function(){return e.displayOneStation(t)}))}))}))}},{key:"displayOneStation",value:function(e){$("#station-name").html(e.name),$("#station-address").html(e.address),$("#station-nb-available-spots").html(e.totalStands.availabilities.stands),$("#station-nb-available-bikes").html(e.totalStands.availabilities.bikes),p(this,b).changeStation(e)}}])&&h(t.prototype,n),i&&h(t,i),e}(),y=new WeakMap,b=new WeakMap,g=new WeakMap,k=new WeakMap;function T(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function M(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}function S(e,t,n){var i=t.get(e);if(!i)throw new TypeError("attempted to set private field on non-instance");if(i.set)i.set.call(e,n);else{if(!i.writable)throw new TypeError("attempted to set read only private field");i.value=n}return n}var x=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),E.set(this,{writable:!0,value:null}),this.retrieveFromSession()}var t,n,i;return t=e,(n=[{key:"retrieveFromSession",value:function(){var e=window.sessionStorage.getItem("reservation");null!=e&&(S(this,E,JSON.parse(e)),this.showReservation())}},{key:"makeReservation",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,i=new Date;i.setMinutes(i.getMinutes()+n),S(this,E,{station:e,renter:t,validUntil:i.getTime()}),window.sessionStorage.setItem("reservation",JSON.stringify(M(this,E))),this.showReservation()}},{key:"showReservation",value:function(){null!=M(this,E)&&($("#reservation-station-name").html(M(this,E).station.name),$("#reservation-first-name").html(M(this,E).renter.firstName),$("#reservation-last-name").html(M(this,E).renter.lastName),this.launchReservationTimer(),$("#reservation").show())}},{key:"launchReservationTimer",value:function(){var e=this;this.updateTimerInformation();var t=setInterval((function(){e.updateTimerInformation()<0&&(clearInterval(t),$("#reservation").hide(),S(e,E,null),window.sessionStorage.setItem("reservation",null))}),1e3)}},{key:"updateTimerInformation",value:function(){var e=(new Date).getTime(),t=M(this,E).validUntil-e,n=Math.floor(t%36e5/6e4),i=Math.floor(t%6e4/1e3);return $("#reservation-remaining-time").html(n+"min "+i+"s"),t}}])&&T(t.prototype,n),i&&T(t,i),e}(),E=new WeakMap;function C(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function O(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}function W(e,t,n){var i=t.get(e);if(!i)throw new TypeError("attempted to set private field on non-instance");if(i.set)i.set.call(e,n);else{if(!i.writable)throw new TypeError("attempted to set read only private field");i.value=n}return n}var P=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),j.set(this,{writable:!0,value:void 0}),I.set(this,{writable:!0,value:void 0}),F.set(this,{writable:!0,value:{x:null,y:null}}),N.set(this,{writable:!0,value:!1}),A.set(this,{writable:!0,value:!1}),W(this,j,t),W(this,I,t.get(0).getContext("2d")),this.init()}var t,n,i;return t=e,(n=[{key:"init",value:function(){var e=this;O(this,j).mousedown((function(t){W(e,N,!0),e.draw(e.getMousePosition(t))})),O(this,j).mousemove((function(t){O(e,N)&&e.draw(e.getMousePosition(t))})),O(this,j).mouseup((function(t){e.resetLastPosition(),W(e,N,!1)})),O(this,j).mouseleave((function(t){e.resetLastPosition(),W(e,N,!1)}))}},{key:"getMousePosition",value:function(e){var t=O(this,j).get(0),n=t.getBoundingClientRect(),i=t.width/n.width,a=t.height/n.height;return{x:(e.clientX-n.left)*i,y:(e.clientY-n.top)*a}}},{key:"resetLastPosition",value:function(){W(this,F,{x:null,y:null})}},{key:"draw",value:function(e){O(this,N)&&null!=O(this,F).x&&null!=O(this,F).y&&(O(this,I).beginPath(),O(this,I).strokeStyle="black",O(this,I).lineWidth=3,O(this,I).lineJoin="round",O(this,I).moveTo(O(this,F).x,O(this,F).y),O(this,I).lineTo(e.x,e.y),O(this,I).closePath(),O(this,I).stroke(),W(this,A,!0)),W(this,F,{x:e.x,y:e.y})}},{key:"isSigned",value:function(){return O(this,A)}}])&&C(t.prototype,n),i&&C(t,i),e}(),j=new WeakMap,I=new WeakMap,F=new WeakMap,N=new WeakMap,A=new WeakMap;function J(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function R(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}function z(e,t,n){var i=t.get(e);if(!i)throw new TypeError("attempted to set private field on non-instance");if(i.set)i.set.call(e,n);else{if(!i.writable)throw new TypeError("attempted to set read only private field");i.value=n}return n}var D=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),_.set(this,{writable:!0,value:null}),$("body").append('<div id="alert" class="modal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Erreur</h5><button type="button" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"><p>'+t+'</p></div><div class="modal-footer"><button type="button" id="close-alert" class="btn btn-secondary">OK</button></div></div></div></div>'),z(this,_,$("#alert")),R(this,_).show(),R(this,_).find(".close").click((function(){return n.close()})),R(this,_).find("#close-alert").click((function(){return n.close()}))}var t,n,i;return t=e,(n=[{key:"close",value:function(){R(this,_).remove(),z(this,_,null)}}])&&J(t.prototype,n),i&&J(t,i),e}(),_=new WeakMap;function V(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Y(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}function K(e,t,n){var i=t.get(e);if(!i)throw new TypeError("attempted to set private field on non-instance");if(i.set)i.set.call(e,n);else{if(!i.writable)throw new TypeError("attempted to set read only private field");i.value=n}return n}var B=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),U.set(this,{writable:!0,value:void 0}),q.set(this,{writable:!0,value:null}),X.set(this,{writable:!0,value:null}),K(this,U,t),$("body").append('<div id="signature-dialog" class="modal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Signature</h5><button type="button" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"><canvas id="signature"></canvas></div><div class="modal-footer"><button type="button" id="dismiss-signature" class="btn btn-secondary">Fermer</button><button type="button" id="save-signature" class="btn btn-primary">Valider</button></div></div></div></div>'),K(this,q,$("#signature-dialog")),Y(this,q).show(),Y(this,q).find(".close").click((function(){return n.close()})),Y(this,q).find("#dismiss-signature").click((function(){return n.close()})),Y(this,q).find("#save-signature").click((function(){return n.submit()})),K(this,X,new P($("#signature")))}var t,n,i;return t=e,(n=[{key:"submit",value:function(){Y(this,X).isSigned()?(Y(this,U).call(this),this.close()):new D("Vous devez signer !")}},{key:"close",value:function(){Y(this,q).remove(),K(this,q,null)}}])&&V(t.prototype,n),i&&V(t,i),e}(),U=new WeakMap,q=new WeakMap,X=new WeakMap;function Z(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function G(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}function H(e,t,n){var i=t.get(e);if(!i)throw new TypeError("attempted to set private field on non-instance");if(i.set)i.set.call(e,n);else{if(!i.writable)throw new TypeError("attempted to set read only private field");i.value=n}return n}var Q=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ee.set(this,{writable:!0,value:void 0}),te.set(this,{writable:!0,value:null}),ne.set(this,{writable:!0,value:{lastName:null,firstName:null}}),H(this,ee,t),this.retrieveFromLocalStorage(),$("#reservation-form").submit((function(e){e.preventDefault(),n.showSignatureDialog()}))}var t,n,i;return t=e,(n=[{key:"retrieveFromLocalStorage",value:function(){var e=window.localStorage.getItem("name");null!=e&&(H(this,ne,JSON.parse(e)),$("#reservation-last-name-field").val(G(this,ne).lastName),$("#reservation-first-name-field").val(G(this,ne).firstName))}},{key:"changeStation",value:function(e){H(this,te,e)}},{key:"showSignatureDialog",value:function(){var e=this;this.checkFormFields()&&new B((function(){return e.saveReservation()}))}},{key:"saveReservation",value:function(){if(this.checkFormFields()){var e=$("#reservation-last-name-field").val(),t=$("#reservation-first-name-field").val();H(this,ne,{lastName:e,firstName:t}),window.localStorage.setItem("name",JSON.stringify(G(this,ne))),G(this,ee).makeReservation(G(this,te),G(this,ne),20)}}},{key:"checkFormFields",value:function(){var e=$("#reservation-last-name-field").val(),t=$("#reservation-first-name-field").val();return""==e||""==t?(new D("Entrez votre nom complet !"),!1):null==G(this,te)?(new D("Vous devez choisir une station !"),!1):0!=G(this,te).totalStands.availabilities.bikes||(new D("Plus de vélos disponibles !"),!1)}}])&&Z(t.prototype,n),i&&Z(t,i),e}(),ee=new WeakMap,te=new WeakMap,ne=new WeakMap,ie=[43.6038333,1.4419812];$(document).ready((function(){new o("#diaporama",5).start();var e=new f("map",ie,"pk.eyJ1IjoicmVtaS1zYW4iLCJhIjoiY2thejAwZXY3MDh0bjJ5cWtmenJvMGkydSJ9.hclc6yA73k1eHUqhJBqzOQ"),t=new x,n=new Q(t);new m(e,n,"bd2828fd25e57a045abb00865462edddcac90de8","toulouse").displayAllStations()}))}]);